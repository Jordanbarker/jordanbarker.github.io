
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Statistical Tests (A/B Testing) &#8212; Data Science Cookbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../_static/book.css?v=4c0c071e" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Notebooks/statistical_tests';</script>
    <link rel="canonical" href="jordanbarker.github.io/Notebooks/statistical_tests.html" />
    <link rel="icon" href="../_static/logo.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Time Series" href="time_series.html" />
    <link rel="prev" title="Scaling" href="scaling.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo_with_text.png" class="logo__image only-light" alt="Data Science Cookbook - Home"/>
    <img src="../_static/logo_with_text.png" class="logo__image only-dark pst-js-only" alt="Data Science Cookbook - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="python_fundamentals.html">Python Fundamentals <a class="anchor" id="chapter1"></a></a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="package_management.html">Package Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="numpy.html">Numpy</a></li>
<li class="toctree-l2"><a class="reference internal" href="pandas.html">Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="object_oriented_programming.html">Object-Oriented Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="logging.html">Logging</a></li>
<li class="toctree-l2"><a class="reference internal" href="parallel_processing.html">Parallel Processing</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="anomaly_detection.html">Anomaly Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="distributions.html">Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation_metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimization.html">Optimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="scaling.html">Scaling</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Statistical Tests (A/B Testing)</a></li>
<li class="toctree-l1"><a class="reference internal" href="time_series.html">Time Series</a></li>
<li class="toctree-l1"><a class="reference internal" href="visualizations.html">Visualizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="uncertainty.html">Uncertainty</a></li>
<li class="toctree-l1"><a class="reference internal" href="cookbook_meta.html">Cookbook Meta</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/Jordanbarker/jordanbarker.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/Jordanbarker/jordanbarker.github.io/issues/new?title=Issue%20on%20page%20%2FNotebooks/statistical_tests.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/Notebooks/statistical_tests.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Statistical Tests (A/B Testing)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-to-assess-statistical-significance">Steps to Assess Statistical Significance: <a name="assess-significance"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power">Sample Size and Statistical Power: <a name="Sample-Size-and-Statstical-Power"></a> <br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-minimum-detectable-effect">Sample Size and Minimum Detectable Effect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#margin-of-error-moe">Margin of Error (MoE)  <a name="Margin of Error"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-proportion-moe">Sample Proportion MoE</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-mean-moe">Sample Mean MoE</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-ci">Confidence Intervals (CI)  <a name="Confidence Intervals"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-statstical-tests">Common Statstical Tests <a name="common-statistical-tests"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#z-tests-t-tests-compare-the-means-of-two-groups"><strong>Z-tests / T-tests</strong>: Compare the means of two groups.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anova-analysis-of-variance-compare-the-means-of-three-or-more-groups"><strong>ANOVA (Analysis of Variance)</strong>: Compare the means of three or more groups.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-signed-rank-test-non-parametric-test-to-compare-the-median-of-a-set-of-numbers-against-a-hypothetical-median"><strong>Wilcoxon Signed-Rank Test</strong>: Non-parametric test to compare the median of a set of numbers against a hypothetical median.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mann-whitney-u-test-non-parametric-test-to-determine-whether-a-numeric-outcome-variable-with-any-distribution-differs-across-two-independent-groups"><strong>Mann-Whitney U-Test</strong>: Non-parametric test to determine whether a numeric outcome variable with any distribution differs across two independent groups.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-tests-test-the-relationship-between-categorical-variables"><strong>Chi-squared Tests</strong>: Test the relationship between categorical variables.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-analysis-model-the-relationship-between-a-dependent-variable-and-one-or-more-independent-variables"><strong>Regression Analysis</strong>: Model the relationship between a dependent variable and one or more independent variables.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-tests-one-sample">T-Tests: One-Sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-tests-independent-two-sample">T-Tests: Independent (Two-sample)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#welch-s-t-test-for-unequal-variance">Welch’s t-test for unequal variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-tests-paired-dependent">T-Tests: Paired (Dependent)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-signed-rank-test">Wilcoxon Signed-Rank Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-square-goodness-of-fit">Chi-square Goodness of Fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-independence-fisher-s-exact-test-g-test">Chi-squared Independence / Fisher’s Exact Test / G-Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-square-goodness-of-fit-test">Chi-square Goodness-of-Fit Test:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#g-test-goodness-of-fit">G-Test (Goodness-of-Fit):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-way-anova">One-way ANOVA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permutation-test">Permutation Test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-value-correction-for-multiple-tests">P-Value Correction for Multiple Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonferroni-correction">Bonferroni correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#false-discovery-rate-fdr">False discovery rate (FDR)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-tests-example">Multiple Tests Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-testing">Sequential Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-spending">Alpha-Spending <a name="Alpha-Spending"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-a-b-testing">Bayesian A/B testing <a name="Bayesian"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-distribution-tests">Data Distribution Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapiro-wilk-test-normal-distributions">Shapiro-Wilk Test (Normal Distributions)  <a name="Shapiro-Wilk"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kolmogorov-smirnov-test">Kolmogorov-Smirnov Test <a name="Kolmogorov-Smirnov"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kullbackleibler-divergence">Kullback–Leibler divergence <a name="Kullback–Leibler"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpson-s-paradox">Simpson’s Paradox</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="statistical-tests-a-b-testing">
<h1>Statistical Tests (A/B Testing)<a class="headerlink" href="#statistical-tests-a-b-testing" title="Link to this heading">#</a></h1>
<section id="steps-to-assess-statistical-significance">
<h2>Steps to Assess Statistical Significance: <a name="assess-significance"></a><a class="headerlink" href="#steps-to-assess-statistical-significance" title="Link to this heading">#</a></h2>
<ol class="arabic simple">
<li><p>Formulate Hypotheses:</p>
<ul class="simple">
<li><p>Null Hypothesis (<span class="math notranslate nohighlight">\(H_0\)</span>): There is no effect, and any observed results are due to random chance.</p></li>
<li><p>Alternative Hypothesis (<span class="math notranslate nohighlight">\(H_a\)</span>): There is a real effect or difference.</p></li>
</ul>
</li>
<li><p>Choose Significance Level (<span class="math notranslate nohighlight">\(α\)</span>): The probability of rejecting the null hypothesis when it is true (Type I error). Commonly 0.05.</p></li>
<li><p>Select Statistical Test: Common tests include t-tests, chi-square tests, ANOVA, and regression analysis.</p></li>
<li><p>Calculate Test Statistic and P-value.</p></li>
</ol>
<p><strong>Note</strong>:
In a business context, it’s also important to clarify the purpose and value of the experiment. Is it worth running a test?
Define metrics:</p>
<ul class="simple">
<li><p>Success metrics that quantify a desired change.</p></li>
<li><p>Tracking metrics help explain the movement in the success metrics.</p></li>
<li><p>Guardrail metrics that you do not want to harm.</p></li>
</ul>
<section id="sample-size-and-statistical-power">
<h3>Sample Size and Statistical Power: <a name="Sample-Size-and-Statstical-Power"></a> <br><a class="headerlink" href="#sample-size-and-statistical-power" title="Link to this heading">#</a></h3>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p></p></th>
<th class="head"><p><strong><span class="math notranslate nohighlight">\(H_0\)</span> is True</strong></p></th>
<th class="head"><p><strong><span class="math notranslate nohighlight">\(H_0\)</span> is False</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Test Rejects <span class="math notranslate nohighlight">\(H_0\)</span></strong></p></td>
<td><p>Significance Level  (<span class="math notranslate nohighlight">\(α\)</span>)</p></td>
<td><p>Power (<span class="math notranslate nohighlight">\(1-β\)</span>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Test Accepts <span class="math notranslate nohighlight">\(H_0\)</span></strong></p></td>
<td><p><span class="math notranslate nohighlight">\(1-α\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\(β\)</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(α\)</span> = probability of a Type I error, known as a “false positive”.</p></li>
<li><p><span class="math notranslate nohighlight">\(β\)</span> = probability of a Type II error, known as a “false negative”.</p></li>
<li><p><span class="math notranslate nohighlight">\(1 − α\)</span> = probability of a “true negative”, i.e., correctly not rejecting the null hypothesis.</p></li>
<li><p><span class="math notranslate nohighlight">\(1 − β\)</span> = probability of a “true positive”, i.e., correctly rejecting the null hypothesis. The <strong>power</strong> of the test.</p></li>
</ul>
<div class="cell tag_hide-input docutils container">
<details class="hide above-input">
<summary aria-label="Toggle hidden content">
<span class="collapsed">Show code cell source</span>
<span class="expanded">Hide code cell source</span>
</summary>
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">matplotlib.pyplot</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">plt</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">scipy.stats</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">stats</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">betas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">]</span>
<span class="n">powers</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="o">-</span> <span class="n">beta</span> <span class="k">for</span> <span class="n">beta</span> <span class="ow">in</span> <span class="n">betas</span><span class="p">]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">critical_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">sharey</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;Power of a Statistical Test&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probability Density&#39;</span><span class="p">)</span>


<span class="k">for</span> <span class="n">ax</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">power</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">axs</span><span class="p">,</span> <span class="n">betas</span><span class="p">,</span> <span class="n">powers</span><span class="p">):</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Distribution under $H_0$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">power</span><span class="p">),</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Distribution under $H_1$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&gt;=</span> <span class="n">critical_value</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">critical_value</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Type I error (α)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">power</span><span class="p">),</span> <span class="n">where</span><span class="o">=</span><span class="p">(</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">critical_value</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="o">-</span><span class="n">critical_value</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Type II error (β)&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">critical_value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Critical Value for α&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="o">-</span><span class="n">critical_value</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha/2$&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">alpha/2$&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.02</span><span class="p">,</span> <span class="s1">&#39;$1-</span><span class="se">\\</span><span class="s1">alpha$&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;Power</span><span class="se">\n</span><span class="s1">$(1-</span><span class="se">\\</span><span class="s1">beta)$&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;tab:blue&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;$</span><span class="se">\\</span><span class="s1">beta$&#39;</span><span class="p">,</span> <span class="n">horizontalalignment</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Test Statistic&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;β=</span><span class="si">{</span><span class="n">beta</span><span class="si">}</span><span class="s1">, Power=</span><span class="si">{</span><span class="n">power</span><span class="si">:</span><span class="s1">.02f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</details>
<div class="cell_output docutils container">
<img alt="../_images/9f04161d7973f88498ab570afba33d4f3014c30aef414dfbfb841da25b3deb45.png" src="../_images/9f04161d7973f88498ab570afba33d4f3014c30aef414dfbfb841da25b3deb45.png" />
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The alpha and p-value are not the same!</p>
<ul class="simple">
<li><p><strong>Alpha</strong>: The pre-determined probability of incorrectly rejecting a null hypothesis that is actually true.</p></li>
<li><p><strong>P-value</strong>: The probability of getting a result at least as extreme as observed in the sample. It’s computed from the sample data, based on the type of test.</p></li>
</ul>
<p>If <span class="math notranslate nohighlight">\( p-value &lt; alpha \)</span> then the null hypothesis is rejected.</p>
<p>“the probability that the data could have arisen if the null hypothesis is true,” is not the same as, “the probability that the null hypothesis is true given the data.” <span id="id1">[<a class="reference internal" href="#id6" title="Jacob Cohen. The earth is round (p &lt; .05). American Psychologist, 49(12):997–1003, 1994.">Cohen, 1994</a>]</span></p>
</div>
</section>
<section id="sample-size-and-minimum-detectable-effect">
<h3>Sample Size and Minimum Detectable Effect<a class="headerlink" href="#sample-size-and-minimum-detectable-effect" title="Link to this heading">#</a></h3>
<p>Handy calculators are available online for this such as <span id="id2">[<a class="reference internal" href="#id7" title="Mark A. Kohn and Janet Senyak. Sample size calculators. \textit UCSF CTSI Website, 2025. Available at https://www.sample-size.net/ [Accessed 30 January 2025].">Kohn and Senyak, 2025</a>]</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p0</span> <span class="o">=</span> <span class="mf">0.1</span>  <span class="c1"># Baseline conversion rate</span>
<span class="n">p1</span> <span class="o">=</span> <span class="mf">0.2</span>  <span class="c1"># Target conversion rate</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>  <span class="c1"># Significance level</span>
<span class="n">power</span> <span class="o">=</span> <span class="mf">.8</span>  <span class="c1"># Power</span>

<span class="c1"># Z-scores for significance level and power</span>
<span class="n">z_alpha</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Two-tailed test</span>
<span class="n">z_beta</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="n">power</span><span class="p">)</span>

<span class="c1"># Variance for baseline and target rates</span>
<span class="n">var_p0</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p0</span><span class="p">)</span>
<span class="n">var_p1</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span>
<span class="n">pooled_proportion</span> <span class="o">=</span> <span class="n">p0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p0</span><span class="p">)</span> <span class="o">+</span> <span class="n">p1</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">p1</span><span class="p">)</span>

<span class="c1"># Minimum Detectable Effect (MDE)</span>
<span class="n">mde</span> <span class="o">=</span> <span class="n">p1</span> <span class="o">-</span> <span class="n">p0</span>

<span class="c1"># Sample size formula</span>
<span class="n">n</span> <span class="o">=</span> <span class="p">((</span><span class="n">z_alpha</span> <span class="o">+</span> <span class="n">z_beta</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">var_p0</span> <span class="o">+</span> <span class="n">var_p1</span><span class="p">))</span> <span class="o">/</span> <span class="p">(</span><span class="n">mde</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>  <span class="c1"># Round up to the nearest whole number</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Required sample size per group: </span><span class="si">{</span><span class="n">sample_size</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total required sample size: </span><span class="si">{</span><span class="n">sample_size</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Required sample size per group: 197.0
Total required sample size: 394.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The standard normal deviate for α = Zα = </span><span class="si">{</span><span class="n">z_alpha</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The standard normal deviate for β = Zβ = </span><span class="si">{</span><span class="n">z_beta</span><span class="si">:</span><span class="s1">.4f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>The standard normal deviate for α = Zα = 1.9600
The standard normal deviate for β = Zβ = 0.8416
</pre></div>
</div>
</div>
</div>
</section>
<section id="margin-of-error-moe">
<h3>Margin of Error (MoE)  <a name="Margin of Error"></a><a class="headerlink" href="#margin-of-error-moe" title="Link to this heading">#</a></h3>
<p>Expresses the sampling error in a survey’s results. It is a range within which the true population parameter is expected to lie, with a certain level of confidence. Used for many things including sample size determination.</p>
<section id="sample-proportion-moe">
<h4>Sample Proportion MoE<a class="headerlink" href="#sample-proportion-moe" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[\text{MoE} = z \times \sqrt{\frac{p(1-p)}{n}}\]</div>
<p>Where:</p>
<ul class="simple">
<li><p>z is the critical value from the standard normal distribution corresponding to the desired confidence level (e.g., 1.96 for 95% confidence).</p></li>
<li><p>p is the sample proportion.</p></li>
<li><p>n is the sample size.</p></li>
</ul>
</section>
<section id="sample-mean-moe">
<h4>Sample Mean MoE<a class="headerlink" href="#sample-mean-moe" title="Link to this heading">#</a></h4>
<div class="math notranslate nohighlight">
\[ \text{MoE} = t \times \frac{s}{\sqrt{n}} \]</div>
<p>Where:</p>
<ul class="simple">
<li><p>t is the critical value from the t-distribution corresponding to the desired confidence level and degrees of freedom.</p></li>
<li><p>s is the sample standard deviation.</p></li>
<li><p>n is the sample size.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mf">0.40</span><span class="p">,</span> <span class="mf">0.60</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="mf">0.50</span>
<span class="n">sample_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2401</span><span class="p">,</span> <span class="mi">384</span><span class="p">,</span> <span class="mi">96</span><span class="p">]</span>
<span class="n">margins_of_error</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.02</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.10</span><span class="p">]</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;purple&#39;</span><span class="p">]</span>
<span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Sample Size = 2,401</span><span class="se">\n</span><span class="s2">Margin of Error = 2%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Sample Size = 384</span><span class="se">\n</span><span class="s2">Margin of Error = 5%</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span>
          <span class="s2">&quot;Sample Size = 96</span><span class="se">\n</span><span class="s2">Margin of Error = 10%&quot;</span><span class="p">]</span>

<span class="k">for</span> <span class="n">sample_size</span><span class="p">,</span> <span class="n">margin_of_error</span><span class="p">,</span> <span class="n">color</span><span class="p">,</span> <span class="n">label</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">sample_sizes</span><span class="p">,</span> <span class="n">margins_of_error</span><span class="p">,</span> <span class="n">colors</span><span class="p">,</span> <span class="n">labels</span><span class="p">):</span>
    <span class="n">std_dev</span> <span class="o">=</span> <span class="n">margin_of_error</span> <span class="o">/</span> <span class="mf">1.96</span>  <span class="c1"># Approximation of standard deviation</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">std_dev</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Proportion&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Distribution of Sample Proportions for Different Sample Sizes </span><span class="se">\n\n</span><span class="s1"> Source: https://en.wikipedia.org/wiki/Margin_of_error&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/5ddd2e38941b5263dd05be18d648a52d08a5d15799e76c8a38d7e75f257e7286.png" src="../_images/5ddd2e38941b5263dd05be18d648a52d08a5d15799e76c8a38d7e75f257e7286.png" />
</div>
</div>
</section>
</section>
<section id="confidence-intervals-ci">
<h3>Confidence Intervals (CI)  <a name="Confidence Intervals"></a><a class="headerlink" href="#confidence-intervals-ci" title="Link to this heading">#</a></h3>
<p>CI is a range of values that are likely to contain the true population parameter (e.g. mean) with a level of confidence. The confidence level represents the proportion of times that the CI would contain the true parameter if the same population were sampled multiple times.</p>
<p>Misrepresentation: “There is a 95% probability that the true parameter lies within this interval.” <br>
True Interpretation: “If we were to take many samples and construct a confidence interval from each sample, we expect 95% of those intervals to contain the true parameter. For any given interval, the true parameter either is in the interval or it isn’t.”</p>
<p>Great overview on the topic: <a class="reference external" href="https://sphweb.bumc.bu.edu/otlt/mph-modules/bs/bs704_confidence_intervals/bs704_confidence_intervals_print.html">Confidence Intervals by Lisa Sullivan, PhD</a></p>
<p>Confidence Interval for One Sample:</p>
<div class="math notranslate nohighlight">
\[ \text{One Sample Confidence Interval} = \text{Sample Mean} \pm MoE \]</div>
<p>Example: Estimate the average test score of students in a school based on a random sample.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">sample_mean</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">sample_std_dev</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">1.96</span>  <span class="c1"># Z value for 95% confidence is 1.96</span>
<span class="n">MoE</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">sample_std_dev</span> <span class="o">/</span> <span class="n">sample_size</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence interval: (</span><span class="si">{</span><span class="n">sample_mean</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">sample_mean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interpretation: we are 95% confident that the true mean is between </span><span class="si">{</span><span class="n">sample_mean</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">sample_mean</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confidence interval: (79.22, 80.78)
Interpretation: we are 95% confident that the true mean is between 79.22 and 80.78.
</pre></div>
</div>
</div>
</div>
<p>Confidence Interval for Two Independent Samples:</p>
<div class="math notranslate nohighlight">
\[ \text{Standard Error (SE)} = \sqrt{\frac{s^2_1}{n_1} + \frac{s^2_2}{n_2}}  \]</div>
<div class="math notranslate nohighlight">
\[ \text{Margin of Error (MoE)} = z * SE \]</div>
<div class="math notranslate nohighlight">
\[ \text{Two Sample Confidence Interval} = \bar{x_1} - \bar{x_2} \pm MoE \]</div>
<p>Example: Compare the average test scores of students from two different schools.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mean_1</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">mean_2</span> <span class="o">=</span> <span class="mi">85</span>
<span class="n">std_dev_1</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">std_dev_2</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">sample_size_1</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">sample_size_2</span> <span class="o">=</span> <span class="mi">25</span>
<span class="n">z</span> <span class="o">=</span> <span class="mf">1.96</span>  <span class="c1"># Z value for 95% confidence</span>
<span class="n">standard_error</span> <span class="o">=</span> <span class="p">((</span><span class="n">std_dev_1</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">sample_size_1</span><span class="p">)</span> <span class="o">+</span> \
                  <span class="p">(</span><span class="n">std_dev_2</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="n">sample_size_2</span><span class="p">))</span><span class="o">**</span><span class="mf">0.5</span>
<span class="n">MoE</span> <span class="o">=</span> <span class="n">z</span> <span class="o">*</span> <span class="n">standard_error</span>
<span class="n">mean_diff</span> <span class="o">=</span> <span class="n">mean_1</span> <span class="o">-</span> <span class="n">mean_2</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Confidence interval: (</span><span class="si">{</span><span class="n">mean_diff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">mean_diff</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Interpretation: We are 95% confident that the true difference between the population means lies between </span><span class="si">{</span><span class="n">mean_diff</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2"> and </span><span class="si">{</span><span class="n">mean_diff</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">MoE</span><span class="si">:</span><span class="s2">0.2f</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Confidence interval: (5.50, 24.50)
Interpretation: We are 95% confident that the true difference between the population means lies between 5.50 and 24.50.
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="common-statstical-tests">
<h2>Common Statstical Tests <a name="common-statistical-tests"></a><a class="headerlink" href="#common-statstical-tests" title="Link to this heading">#</a></h2>
<section id="z-tests-t-tests-compare-the-means-of-two-groups">
<h3><strong>Z-tests / T-tests</strong>: Compare the means of two groups.<a class="headerlink" href="#z-tests-t-tests-compare-the-means-of-two-groups" title="Link to this heading">#</a></h3>
<p><strong>When to use a Z-test vs. T-test?</strong>: Generally, Z-Tests are used when the sample size is large (<span class="math notranslate nohighlight">\(n &gt; 30\)</span>). <br>
<strong>Assumptions</strong>: Normal distribution of data, equal variances between groups, and independence of observations.<br>
<strong>Types</strong>: <br>
- One-sample T-Test: Compares the means of the sample data to the population (e.g., Sample from a factory process). <br>
- Independent (Two-sample) T-test: Compares the means of two independent groups (e.g., comparing the heights of men and women). <br>
– Welch’s T-Test for Unequal Variances should be used instead of the independent t-test regardless since it is more robust. It can be applied without any substantial disadvantages to Student’s t-test. It’s <em>not recommended</em> to pre-test for equal variances and then choose between Student’s t-test or Welch’s t-test. <br>
- Dependent (Paired) T-test: Compares the means of two related groups (e.g., comparing the weights of individuals before and after a diet).</p>
</section>
<section id="anova-analysis-of-variance-compare-the-means-of-three-or-more-groups">
<h3><strong>ANOVA (Analysis of Variance)</strong>: Compare the means of three or more groups.<a class="headerlink" href="#anova-analysis-of-variance-compare-the-means-of-three-or-more-groups" title="Link to this heading">#</a></h3>
<p><strong>Assumptions</strong>: Assumes normal distribution of data, homogeneity of variances, and independence of observations.<br>
<strong>Types</strong>:<br>
- One-way ANOVA: Compares the means of multiple groups based on one factor (e.g., comparing the test scores of students from different schools).<br>
- Two-way ANOVA: Compares the means of groups based on two factors (e.g., comparing the test scores of students from different schools and different grades). <br>
<strong>Note</strong>: Analysis on a one way ANOVA with two independent samples is a T-test.</p>
</section>
<section id="wilcoxon-signed-rank-test-non-parametric-test-to-compare-the-median-of-a-set-of-numbers-against-a-hypothetical-median">
<h3><strong>Wilcoxon Signed-Rank Test</strong>: Non-parametric test to compare the median of a set of numbers against a hypothetical median.<a class="headerlink" href="#wilcoxon-signed-rank-test-non-parametric-test-to-compare-the-median-of-a-set-of-numbers-against-a-hypothetical-median" title="Link to this heading">#</a></h3>
<p><strong>Assumptions</strong>: The data should be ordinal, interval, or ratio scales where ranking is meaningful. While it does not require normality, it assumes that the differences between pairs are symmetrically distributed around the median. <br>
<strong>Note</strong>: More robust alternative to the t-test when dealing with outliers, as it is less sensitive to extreme values due to its reliance on ranks rather than raw data.</p>
<ul class="simple">
<li><p>The Wilcoxon signed-ranks test is the nonparametric alternative for the <strong>dependent</strong> t-test.</p></li>
</ul>
</section>
<section id="mann-whitney-u-test-non-parametric-test-to-determine-whether-a-numeric-outcome-variable-with-any-distribution-differs-across-two-independent-groups">
<h3><strong>Mann-Whitney U-Test</strong>: Non-parametric test to determine whether a numeric outcome variable with any distribution differs across two independent groups.<a class="headerlink" href="#mann-whitney-u-test-non-parametric-test-to-determine-whether-a-numeric-outcome-variable-with-any-distribution-differs-across-two-independent-groups" title="Link to this heading">#</a></h3>
<p><strong>Assumptions</strong>: The data should be ordinal, interval, or ratio scales where ranking is meaningful. While it does not require normality, it assumes that the differences between pairs are symmetrically distributed around the median. <br>
<strong>Note</strong>: This test does not test specifically if the mean or median of two groups are equal, only if the overall distributions are significantly different or not <span id="id3">[<a class="reference internal" href="#id8" title="Mann-whitney u-test. https://sites.utexas.edu/sos/guided/inferential/numeric/onecat/2-groups/independent/u-test/. Accessed: 2025-01-30."><em>Mann-Whitney U-Test</em>, n.d.</a>]</span>.</p>
<ul class="simple">
<li><p>The Mann-Whitney U is the nonparametric alternative to the <strong>independent</strong> t-test.</p></li>
</ul>
</section>
<section id="chi-squared-tests-test-the-relationship-between-categorical-variables">
<h3><strong>Chi-squared Tests</strong>: Test the relationship between categorical variables.<a class="headerlink" href="#chi-squared-tests-test-the-relationship-between-categorical-variables" title="Link to this heading">#</a></h3>
<p><strong>Assumptions</strong>: Assumes a sufficient sample size (expected frequencies in each cell should be at least 5) and independence of observations. <br>
<strong>Types</strong>: <br>
- Independence: Assesses whether there is an association between two categorical variables (e.g., gender and voting preference). <br>
- Goodness-of-Fit: Tests whether the distribution of a single categorical variable matches an expected distribution (e.g., testing if a die is fair). <br>
- Homogeneity: Test if samples came from the same population.</p>
<p><strong>Fisher’s Exact Test</strong>: Test relationship between categorical variables for small sample sizes or small expected frequencies
<strong>Assumptions</strong>: Assumes a sufficient sample size (expected frequencies in each cell should be at least 5) and independence of observations. <br></p>
<p><strong>G-test (Likelihood Ratio Test)</strong>: Increasingly being used over chi-squared tests due to better accuracy and interpretability in some cases, but note that it is unreliable if the sample sizes are small.</p>
</section>
<section id="regression-analysis-model-the-relationship-between-a-dependent-variable-and-one-or-more-independent-variables">
<h3><strong>Regression Analysis</strong>: Model the relationship between a dependent variable and one or more independent variables.<a class="headerlink" href="#regression-analysis-model-the-relationship-between-a-dependent-variable-and-one-or-more-independent-variables" title="Link to this heading">#</a></h3>
<p><strong>Assumptions</strong>: Assumes linearity (linear relationship between dependent and independent variables), independence of errors, homoscedasticity (constant variance of errors), and normality of errors for linear regression. <br>
<strong>Types</strong>:<br>
- Simple Linear Regression: Models the relationship between a dependent variable and a single independent variable (e.g., predicting sales based on advertising budget).<br>
- Multiple Linear Regression: Models the relationship between a dependent variable and multiple independent variables (e.g., predicting house prices based on size, location, and number of rooms).<br>
- Logistic Regression: Used for binary classification problems (e.g., predicting whether a customer will buy a product or not).<br></p>
</section>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">#</a></h2>
<section id="t-tests-one-sample">
<h3>T-Tests: One-Sample<a class="headerlink" href="#t-tests-one-sample" title="Link to this heading">#</a></h3>
<p>When you need to compare the mean from a single sample against a known or hypothesized population mean under assumptions of normality and random sampling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">seaborn</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sns</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s1">&#39;ignore&#39;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="ne">FutureWarning</span><span class="p">)</span>

<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="n">pop_mean</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1"># Known or hypothesized population mean</span>
<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_1samp</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">pop_mean</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="n">p_value</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="o">-</span><span class="mf">0.05</span><span class="p">:</span>  <span class="c1"># 5% significance level</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reject the null hypothesis - sample mean is significantly different from the population mean.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fail to reject the null hypothesis - sample mean is not significantly different from the population mean.&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">pop_mean</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Population Mean&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sample Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T-statistic: -2.4978
P-value: 0.0127
Fail to reject the null hypothesis - sample mean is not significantly different from the population mean.
</pre></div>
</div>
<img alt="../_images/2cae058128589eb370a59e59bd9396ec29042fa70f44fd0d3b4d1a7b8d933516.png" src="../_images/2cae058128589eb370a59e59bd9396ec29042fa70f44fd0d3b4d1a7b8d933516.png" />
</div>
</div>
</section>
<section id="t-tests-independent-two-sample">
<h3>T-Tests: Independent (Two-sample)<a class="headerlink" href="#t-tests-independent-two-sample" title="Link to this heading">#</a></h3>
<p><strong>Groups</strong>: Compares the means of two independent groups. Subjects in one group have no connection to the subjects in the other group.<br>
<strong>Examples</strong>: Comparing the heights of men and women, or test scores of students from two different schools</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">10.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T-Test Assuming Equal Variance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">T-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Welch&#39;s T-Test for Unequal Variance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">T-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#771f4b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;A Mean </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B Mean </span><span class="si">{</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sample Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T-Test Assuming Equal Variance:
	T-statistic: -2.1062
	P-value: 0.0353

Welch&#39;s T-Test for Unequal Variance:
	T-statistic: -2.1062
	P-value: 0.0353
</pre></div>
</div>
<img alt="../_images/8091a83e5104fa665764889713d4bc6eb1615453080255c7a0830333750eb95a.png" src="../_images/8091a83e5104fa665764889713d4bc6eb1615453080255c7a0830333750eb95a.png" />
</div>
</div>
</section>
<section id="welch-s-t-test-for-unequal-variance">
<h3>Welch’s t-test for unequal variance<a class="headerlink" href="#welch-s-t-test-for-unequal-variance" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">10.4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;T-Test Assuming Equal Variance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">T-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Welch&#39;s T-Test for Unequal Variance:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">T-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#771f4b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;A Mean = </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B Mean = </span><span class="si">{</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sample Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>T-Test Assuming Equal Variance:
	T-statistic: -1.8134
	P-value: 0.0699

Welch&#39;s T-Test for Unequal Variance:
	T-statistic: -1.8134
	P-value: 0.0700
</pre></div>
</div>
<img alt="../_images/d4bb4c17875fa50fb098f211a720531087e1303ed17abb42920f0103d8c1a34d.png" src="../_images/d4bb4c17875fa50fb098f211a720531087e1303ed17abb42920f0103d8c1a34d.png" />
</div>
</div>
</section>
<section id="t-tests-paired-dependent">
<h3>T-Tests: Paired (Dependent)<a class="headerlink" href="#t-tests-paired-dependent" title="Link to this heading">#</a></h3>
<p><strong>Groups</strong>: Compares the means of two related groups. Subjects in these groups are connected. Typically through repeated measurements on the same subjects. <br>
<strong>Examples</strong>: Comparing the weights of individuals before and after a diet, or the test scores of students before and after a specific training program</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">10.1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">equal_var</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Independent T-Test:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">T-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>


<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span> <span class="c1"># Before and After</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Paired T-Test:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">T-statistic: </span><span class="si">{</span><span class="n">t_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#771f4b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;A Mean </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B Mean </span><span class="si">{</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sample Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Independent T-Test:
	T-statistic: -1.7186
	P-value: 0.0858

Paired T-Test:
	T-statistic: -1.7073
	P-value: 0.0881
</pre></div>
</div>
<img alt="../_images/a4a09c514a9ead3f8b95468822d5d50e89d4859090bcb5e707aea4767df5178c.png" src="../_images/a4a09c514a9ead3f8b95468822d5d50e89d4859090bcb5e707aea4767df5178c.png" />
</div>
</div>
</section>
<section id="wilcoxon-signed-rank-test">
<h3>Wilcoxon Signed-Rank Test<a class="headerlink" href="#wilcoxon-signed-rank-test" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data: Sleep duration in hours for 10 participants</span>
<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mf">7.8</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mf">7.1</span><span class="p">,</span> <span class="mf">6.3</span><span class="p">])</span> <span class="c1"># Group A: Without sleep aid</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">7.5</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">,</span> <span class="mf">7.4</span><span class="p">,</span> <span class="mf">6.5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mf">7.5</span><span class="p">,</span> <span class="mf">7.2</span><span class="p">,</span> <span class="mf">7.3</span><span class="p">,</span> <span class="mf">6.8</span><span class="p">])</span> <span class="c1"># Group B: With sleep aid</span>
<span class="n">stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">wilcoxon</span><span class="p">(</span><span class="n">A</span> <span class="o">-</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test Statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.04</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-Value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="n">p_value</span> <span class="o">&lt;</span> <span class="mf">0.05</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reject the null hypothesis - suggest a significant difference in sleep duration.&quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fail to reject the null hypothesis - no significant difference in sleep duration.&quot;</span><span class="p">)</span>

<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Independent T-Test on the same data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Test Statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.04</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-Value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_rel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Paired T-Test on the same data:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Test Statistic: </span><span class="si">{</span><span class="n">stat</span><span class="si">:</span><span class="s2">.04</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">P-Value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.05f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">boxplot</span><span class="p">([</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Comparison of Sleep Duration Without and With Sleep Aid&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Hours of Sleep&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Condition&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test Statistic: 0.0
P-Value: 0.0020
Reject the null hypothesis - suggest a significant difference in sleep duration.

Independent T-Test on the same data:
	Test Statistic: 0.0
	P-Value: 0.0925

Paired T-Test on the same data:
	Test Statistic: 0.0
	P-Value: 0.00001
</pre></div>
</div>
<img alt="../_images/75309fab56d7026cca702dec878462a06278c6899c1e86f75ccc38cf156f504f.png" src="../_images/75309fab56d7026cca702dec878462a06278c6899c1e86f75ccc38cf156f504f.png" />
</div>
</div>
</section>
<section id="chi-square-goodness-of-fit">
<h3>Chi-square Goodness of Fit<a class="headerlink" href="#chi-square-goodness-of-fit" title="Link to this heading">#</a></h3>
<p>Note that chi2_contingency performs a two-sided test, so we’re checking for positve and negative effects.</p>
<p><a class="reference external" href="https://www.youtube.com/watch?v=hpWdDmgsIRE">Khan Academy: Contingency table chi-square test</a></p>
<p>Null Hypothesis: Herbs do nothing <br>
Alternative Hypothesis: Herbs do something</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#                 Herb 1      Herb 2   Placebo</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">20</span><span class="p">,</span>         <span class="mi">30</span><span class="p">,</span>      <span class="mi">30</span><span class="p">],</span>        <span class="c1"># Sick </span>
                 <span class="p">[</span><span class="mi">100</span><span class="p">,</span>        <span class="mi">110</span><span class="p">,</span>     <span class="mi">90</span><span class="p">]])</span>       <span class="c1"># Not Sick</span>

<span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_value</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-squared Statistic: </span><span class="si">{</span><span class="n">chi2_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared Statistic: 2.5258
P-value: 0.2828
</pre></div>
</div>
</div>
</div>
</section>
<section id="chi-squared-independence-fisher-s-exact-test-g-test">
<h3>Chi-squared Independence / Fisher’s Exact Test / G-Test<a class="headerlink" href="#chi-squared-independence-fisher-s-exact-test-g-test" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Rows represent categories of variable 1 (e.g., Gender: Male, Female)</span>
<span class="c1"># Columns represent categories of variable 2 (e.g., Preference: Yes, No)</span>
<span class="n">contingency_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">20</span><span class="p">],</span>   <span class="c1">#   Male: 30 Yes, 20 No</span>
                              <span class="p">[</span><span class="mi">35</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])</span>  <span class="c1"># Female: 35 Yes, 15 No</span>

<span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-squared statistic: </span><span class="si">{</span><span class="n">chi2_stat</span><span class="si">:</span><span class="s2">.02f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_val</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">odds_ratio</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">fisher_exact</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fisher&#39;s Exact Test statistic: </span><span class="si">{</span><span class="n">odds_ratio</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="s2">&quot;log-likelihood&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;G-Test statistic: </span><span class="si">{</span><span class="n">chi2_stat</span><span class="si">:</span><span class="s2">.02f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_val</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared statistic: 0.70
P-value: 0.4017

Fisher&#39;s Exact Test statistic: 0.6429
P-value: 0.4019

G-Test statistic: 0.70
P-value: 0.4013
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="sd">&quot;&quot;&quot; Source: Berger, Jeffrey S. et al. “Aspirin for the Primary Prevention of Cardiovascular Events in Women and Men: A Sex-Specific Meta-analysis of Randomized Controlled Trials.” JAMA, 295(3):306-313, DOI:10.1001/jama.295.3.306, 2006.</span>
<span class="sd">        https://jamanetwork.com/journals/jama/article-abstract/202217</span>
<span class="sd">        </span>
<span class="sd">                    Aspirin   Control/Placebo</span>
<span class="sd">Ischemic stroke       176           230</span>
<span class="sd">No stroke           21035         21018</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="n">contingency_table</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">176</span><span class="p">,</span> <span class="mi">230</span><span class="p">],</span> 
                              <span class="p">[</span><span class="mi">21035</span><span class="p">,</span> <span class="mi">21018</span><span class="p">]])</span>

<span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-squared statistic: </span><span class="si">{</span><span class="n">chi2_stat</span><span class="si">:</span><span class="s2">.02f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_val</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">odds_ratio</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">fisher_exact</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Fisher&#39;s Exact Test statistic: </span><span class="si">{</span><span class="n">odds_ratio</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_val</span><span class="p">,</span> <span class="n">dof</span><span class="p">,</span> <span class="n">expected</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2_contingency</span><span class="p">(</span><span class="n">contingency_table</span><span class="p">,</span> <span class="n">lambda_</span><span class="o">=</span><span class="s2">&quot;log-likelihood&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;G-Test statistic: </span><span class="si">{</span><span class="n">chi2_stat</span><span class="si">:</span><span class="s2">.02f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_val</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared statistic: 6.89
P-value: 0.0087

Fisher&#39;s Exact Test statistic: 0.7646
P-value: 0.0081

G-Test statistic: 6.91
P-value: 0.0086
</pre></div>
</div>
</div>
</div>
</section>
<section id="chi-square-goodness-of-fit-test">
<h3>Chi-square Goodness-of-Fit Test:<a class="headerlink" href="#chi-square-goodness-of-fit-test" title="Link to this heading">#</a></h3>
<p><a class="reference external" href="https://www.youtube.com/watch?v=2QeDRsxSF9M">Khan Academy Example</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#          Day:     M   T   W   T   F   S</span>
<span class="n">expected_freq</span> <span class="o">=</span>   <span class="p">[</span><span class="mf">.1</span><span class="p">,</span> <span class="mf">.1</span><span class="p">,</span> <span class="mf">.15</span><span class="p">,</span> <span class="mf">.2</span><span class="p">,</span> <span class="mf">.3</span><span class="p">,</span> <span class="mf">.15</span><span class="p">]</span>  <span class="c1"># Expected frequencies in each category. By default the categories are assumed to be equally likely.</span>
<span class="n">observed_counts</span> <span class="o">=</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>  <span class="c1"># Observed values in each category.</span>
<span class="n">observed_freq</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="nb">sum</span><span class="p">(</span><span class="n">observed_counts</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">observed_counts</span><span class="p">]</span> <span class="c1"># Normalize observed values to frequencies.</span>
<span class="n">expected_counts</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="nb">sum</span><span class="p">(</span><span class="n">observed_counts</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">expected_freq</span><span class="p">]</span>

<span class="n">chi2_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chisquare</span><span class="p">(</span><span class="n">f_obs</span><span class="o">=</span><span class="n">observed_counts</span><span class="p">,</span> <span class="n">f_exp</span><span class="o">=</span><span class="n">expected_counts</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Chi-squared Statistic: </span><span class="si">{</span><span class="n">chi2_stat</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Chi-squared Statistic: 11.4417
P-value: 0.0433
</pre></div>
</div>
</div>
</div>
</section>
<section id="g-test-goodness-of-fit">
<h3>G-Test (Goodness-of-Fit):<a class="headerlink" href="#g-test-goodness-of-fit" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">observed_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">observed_counts</span><span class="p">)</span>
<span class="n">expected_counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">expected_counts</span><span class="p">)</span>
<span class="n">G_statistic</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">observed_counts</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">observed_counts</span> <span class="o">/</span> <span class="n">expected_counts</span><span class="p">))</span>
<span class="n">degrees_of_freedom</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_counts</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">chi2</span><span class="o">.</span><span class="n">sf</span><span class="p">(</span><span class="n">G_statistic</span><span class="p">,</span> <span class="n">degrees_of_freedom</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;G-statistic: </span><span class="si">{</span><span class="n">G_statistic</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>G-statistic: 11.3865
P-value: 0.0442
</pre></div>
</div>
</div>
</div>
</section>
<section id="one-way-anova">
<h3>One-way ANOVA<a class="headerlink" href="#one-way-anova" title="Link to this heading">#</a></h3>
<p>Tests whether two or more groups have the same population mean.</p>
<p><a class="reference external" href="https://www.youtube.com/watch?v=9cnSWads6oo">Zedstatstics Example</a></p>
<p><span class="math notranslate nohighlight">\(
\text{Sum of Squares = SST} = \sum ({X - \overline{X}})^2
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\text{Sum of Squares Within Groups = SSW} = \sum ({\overline{X} - \overline{\overline{X}_i}})^2
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\text{Sum of Squares Between Groups = SSB} = \sum ({X_i - \overline{X}})^2
\)</span></p>
<p><span class="math notranslate nohighlight">\(
\text{F} = \frac{\frac{\text{SSB}}{c - 1}} {\frac{\text{SSW}}{n - c}}
\\ \text{Where:}
\\ \quad \text{c = number of categories}
\\ \quad \text{n = number of observations}
\)</span></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">SSW</span><span class="p">(</span><span class="n">group</span><span class="p">):</span>
    <span class="n">X_bar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">([(</span><span class="n">num</span><span class="o">-</span><span class="n">X_bar</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">num</span> <span class="ow">in</span> <span class="n">group</span><span class="p">])</span>

<span class="k">def</span><span class="w"> </span><span class="nf">SSB</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">global_mean</span><span class="p">):</span>
    <span class="n">X_bar</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">X_bar</span> <span class="o">-</span> <span class="n">global_mean</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span><span class="w"> </span><span class="nf">f_stat</span><span class="p">(</span><span class="n">SSB</span><span class="p">,</span> <span class="n">SSW</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">SSB</span> <span class="o">/</span> <span class="p">(</span><span class="n">c</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="p">((</span><span class="n">SSW</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="n">c</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">group2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span>
<span class="n">group3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
<span class="n">group_means</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
<span class="n">global_mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">group_means</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_means</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s2">&quot;     F-Statstic:&quot;</span><span class="p">,</span> <span class="n">f_stat</span><span class="p">(</span><span class="n">SSB</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">global_mean</span><span class="p">),</span> <span class="n">SSW</span><span class="p">(</span><span class="n">group</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="s2">&quot;   SSW:&quot;</span><span class="p">,</span> <span class="n">SSW</span><span class="p">(</span><span class="n">group</span><span class="p">),</span> <span class="s2">&quot;   SSB:&quot;</span><span class="p">,</span> <span class="n">SSB</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">global_mean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 5, 9]      F-Statstic: 0.0    SSW: 32.0    SSB: 0.0
[3, 5, 7]      F-Statstic: 0.0    SSW: 8.0    SSB: 0.0
[4, 5, 6]      F-Statstic: 0.0    SSW: 2.0    SSB: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">group2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">group3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">]</span>

<span class="n">n</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">groups</span><span class="p">)</span>
<span class="n">group_means</span> <span class="o">=</span> <span class="p">[</span><span class="nb">sum</span><span class="p">(</span><span class="n">group</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">group</span><span class="p">)</span> <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">]</span>
<span class="n">global_mean</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">group_means</span><span class="p">)</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">group_means</span><span class="p">)</span>

<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="s2">&quot;     F-Statstic:&quot;</span><span class="p">,</span> <span class="n">f_stat</span><span class="p">(</span><span class="n">SSB</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">global_mean</span><span class="p">),</span> <span class="n">SSW</span><span class="p">(</span><span class="n">group</span><span class="p">),</span> <span class="n">n</span><span class="p">,</span> <span class="n">c</span><span class="p">),</span> <span class="s2">&quot;   SSW:&quot;</span><span class="p">,</span> <span class="n">SSW</span><span class="p">(</span><span class="n">group</span><span class="p">),</span> <span class="s2">&quot;   SSB:&quot;</span><span class="p">,</span> <span class="n">SSB</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">global_mean</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 3, 5]      F-Statstic: 4.5    SSW: 8.0    SSB: 12.0
[5, 7, 9]      F-Statstic: 4.5    SSW: 8.0    SSB: 12.0
[4, 5, 6]      F-Statstic: 0.0    SSW: 2.0    SSB: 0.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">group1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">24</span><span class="p">]</span>
<span class="n">group2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">28</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">27</span><span class="p">]</span>
<span class="n">group3</span> <span class="o">=</span> <span class="p">[</span><span class="mi">25</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">28</span><span class="p">]</span>
<span class="n">f_statistic</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">f_oneway</span><span class="p">(</span><span class="n">group1</span><span class="p">,</span> <span class="n">group2</span><span class="p">,</span> <span class="n">group3</span><span class="p">)</span> <span class="c1"># Perform one-way ANOVA</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;F-statistic: </span><span class="si">{</span><span class="n">f_statistic</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.06f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>F-statistic: 25.8788
P-value: 0.000044
</pre></div>
</div>
</div>
</div>
</section>
<section id="permutation-test">
<h3>Permutation Test<a class="headerlink" href="#permutation-test" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">perform_permutation_test</span><span class="p">(</span><span class="n">combined</span><span class="p">,</span> <span class="n">size1</span><span class="p">,</span> <span class="n">size2</span><span class="p">,</span> <span class="n">num_permutations</span><span class="o">=</span><span class="mi">10000</span><span class="p">):</span>
    <span class="n">perm_diffs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num_permutations</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_permutations</span><span class="p">):</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">combined</span><span class="p">)</span>
        <span class="n">new_group1</span> <span class="o">=</span> <span class="n">combined</span><span class="p">[:</span><span class="n">size1</span><span class="p">]</span>
        <span class="n">new_group2</span> <span class="o">=</span> <span class="n">combined</span><span class="p">[</span><span class="n">size1</span><span class="p">:</span><span class="n">size1</span><span class="o">+</span><span class="n">size2</span><span class="p">]</span>
        <span class="n">perm_diffs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">new_group2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">new_group1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">perm_diffs</span>

<span class="n">data_group1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>  <span class="c1"># Mean score group 1</span>
<span class="n">data_group2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span> <span class="c1"># Mean score of group 2</span>
<span class="n">observed_diff</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_group2</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">data_group1</span><span class="p">)</span>
<span class="n">combined_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">data_group1</span><span class="p">,</span> <span class="n">data_group2</span><span class="p">])</span>

<span class="c1"># Perform the permutation test</span>
<span class="n">perm_diffs</span> <span class="o">=</span> <span class="n">perform_permutation_test</span><span class="p">(</span><span class="n">combined_data</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_group1</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">data_group2</span><span class="p">))</span>
<span class="n">p_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">perm_diffs</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_diff</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Observed difference in means: </span><span class="si">{</span><span class="n">observed_diff</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;P-value from permutation test: </span><span class="si">{</span><span class="n">p_value</span><span class="si">:</span><span class="s2">.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">perm_diffs</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.75</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Permutation Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">observed_diff</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Observed Difference&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=-</span><span class="n">observed_diff</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Difference in means&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Frequency&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Permutation Test Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Observed difference in means: 0.0932
P-value from permutation test: 0.6344
</pre></div>
</div>
<img alt="../_images/af83a3463b8c642d78b6f7b80634d7d68c77ef237ba783b26b41c82d2c9cb60b.png" src="../_images/af83a3463b8c642d78b6f7b80634d7d68c77ef237ba783b26b41c82d2c9cb60b.png" />
</div>
</div>
</section>
</section>
<section id="p-value-correction-for-multiple-tests">
<h2>P-Value Correction for Multiple Tests<a class="headerlink" href="#p-value-correction-for-multiple-tests" title="Link to this heading">#</a></h2>
<p>Family-wise error rate (FWER) is the probability of rejecting the null hypothesis when it is actually true while performing multiple hypotheses tests.</p>
<section id="bonferroni-correction">
<h3>Bonferroni correction<a class="headerlink" href="#bonferroni-correction" title="Link to this heading">#</a></h3>
<p>When multiple hypothesis tests are conducted, the Bonferroni correction can help to maintain the overall false positive error rate at a desired level.</p>
<p>The Bonferroni correction can be conservative if the test statistics are positively correlated.</p>
</section>
<section id="false-discovery-rate-fdr">
<h3>False discovery rate (FDR)<a class="headerlink" href="#false-discovery-rate-fdr" title="Link to this heading">#</a></h3>
<p>Estimates the proportion of false discoveries among a set of hypothesis tests.</p>
<p>Less conservative than the Bonferroni correction, because it takes into account the distribution of p-values in the data.</p>
<p>There are several methods available on <a class="reference external" href="https://www.statsmodels.org/stable/generated/statsmodels.stats.multitest.multipletests.html">statsmodels</a>. I run these two below:</p>
<ul class="simple">
<li><p>Benjamini–Hochberg: Proven for independent test statistics, and has been shown to be robust to violations of the independence assumption.</p></li>
<li><p>Benjamini–Yekutieli: A more conservative extension that controls for correlated tests.</p></li>
</ul>
<p><a class="reference external" href="https://www.mv.helsinki.fi/home/mjxpirin/HDS_course/material/HDS2_FDR.html">Matti Pirinen</a> has great lecture notes online that dive deeper into the details of False Discovery Rates by
that dives deeper into .</p>
</section>
<section id="multiple-tests-example">
<h3>Multiple Tests Example<a class="headerlink" href="#multiple-tests-example" title="Link to this heading">#</a></h3>
<p>Three independent two-sample t-tests are performed comparing random data for three groups</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">statsmodels.stats.multitest</span><span class="w"> </span><span class="kn">import</span> <span class="n">multipletests</span>

<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">sample_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">n_tests</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">data1</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>
<span class="n">data3</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>
<span class="n">t_stat1</span><span class="p">,</span> <span class="n">p_val1</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">)</span>
<span class="n">t_stat2</span><span class="p">,</span> <span class="n">p_val2</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data1</span><span class="p">,</span> <span class="n">data3</span><span class="p">)</span>
<span class="n">t_stat3</span><span class="p">,</span> <span class="n">p_val3</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">ttest_ind</span><span class="p">(</span><span class="n">data2</span><span class="p">,</span> <span class="n">data3</span><span class="p">)</span>
<span class="n">p_values</span> <span class="o">=</span> <span class="p">[</span><span class="n">p_val1</span><span class="p">,</span> <span class="n">p_val2</span><span class="p">,</span> <span class="n">p_val3</span><span class="p">]</span>
<span class="c1"># print(f&quot;Original p-values: {p_val1:.4f}, {p_val2:.4f}, {p_val3:.4f}&quot;)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Bonferroni Correction Results:&quot;</span><span class="p">)</span>
<span class="n">rejected</span><span class="p">,</span> <span class="n">pvals_corrected</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bonferroni&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">orig_p</span><span class="p">,</span> <span class="n">adj_p</span><span class="p">,</span> <span class="n">rej</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">pvals_corrected</span><span class="p">,</span> <span class="n">rejected</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;Rejected&#39;</span> <span class="k">if</span> <span class="n">rej</span> <span class="k">else</span> <span class="s1">&#39;Not rejected&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: Original p = </span><span class="si">{</span><span class="n">orig_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Adjusted p = </span><span class="si">{</span><span class="n">adj_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">FDR with Benjamini-Hochberg Procedure:&quot;</span><span class="p">)</span>
<span class="n">rejected</span><span class="p">,</span> <span class="n">pvals_corrected</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fdr_bh&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">orig_p</span><span class="p">,</span> <span class="n">adj_p</span><span class="p">,</span> <span class="n">rej</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">pvals_corrected</span><span class="p">,</span> <span class="n">rejected</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;Rejected&#39;</span> <span class="k">if</span> <span class="n">rej</span> <span class="k">else</span> <span class="s1">&#39;Not rejected&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: Original p = </span><span class="si">{</span><span class="n">orig_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Adjusted p = </span><span class="si">{</span><span class="n">adj_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">FDR with Benjamini–Yekutieli Procedure):&quot;</span><span class="p">)</span>
<span class="n">rejected</span><span class="p">,</span> <span class="n">pvals_corrected</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multipletests</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;fdr_by&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">orig_p</span><span class="p">,</span> <span class="n">adj_p</span><span class="p">,</span> <span class="n">rej</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">p_values</span><span class="p">,</span> <span class="n">pvals_corrected</span><span class="p">,</span> <span class="n">rejected</span><span class="p">),</span> <span class="n">start</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">status</span> <span class="o">=</span> <span class="s1">&#39;Rejected&#39;</span> <span class="k">if</span> <span class="n">rej</span> <span class="k">else</span> <span class="s1">&#39;Not rejected&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Test </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">: Original p = </span><span class="si">{</span><span class="n">orig_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, Adjusted p = </span><span class="si">{</span><span class="n">adj_p</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">status</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Bonferroni Correction Results:
Test 1: Original p = 0.9132, Adjusted p = 1.0000, Not rejected
Test 2: Original p = 0.9604, Adjusted p = 1.0000, Not rejected
Test 3: Original p = 0.8773, Adjusted p = 1.0000, Not rejected

FDR with Benjamini-Hochberg Procedure:
Test 1: Original p = 0.9132, Adjusted p = 0.9604, Not rejected
Test 2: Original p = 0.9604, Adjusted p = 0.9604, Not rejected
Test 3: Original p = 0.8773, Adjusted p = 0.9604, Not rejected

FDR with Benjamini–Yekutieli Procedure):
Test 1: Original p = 0.9132, Adjusted p = 1.0000, Not rejected
Test 2: Original p = 0.9604, Adjusted p = 1.0000, Not rejected
Test 3: Original p = 0.8773, Adjusted p = 1.0000, Not rejected
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="sequential-testing">
<h2>Sequential Testing<a class="headerlink" href="#sequential-testing" title="Link to this heading">#</a></h2>
<section id="alpha-spending">
<h3>Alpha-Spending <a name="Alpha-Spending"></a><a class="headerlink" href="#alpha-spending" title="Link to this heading">#</a></h3>
<p>O’Brien-Fleming Method: calculates the alpha threshold for a given interim analysis point. This method provides more stringent alpha control early in the experiment and relaxes as more data becomes available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">obrien_fleming</span><span class="p">(</span><span class="n">spending_time</span><span class="p">,</span> <span class="n">total_time</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.05</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Calculate alpha threshold at a given time using O&#39;Brien-Fleming method &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">*</span> <span class="p">(</span><span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span><span class="p">)</span> <span class="o">/</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">alpha</span> <span class="o">*</span> <span class="n">spending_time</span> <span class="o">/</span> <span class="n">total_time</span><span class="p">))</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

<span class="c1"># Points in time when the interim analyses are performed (fraction of total data collected)</span>
<span class="n">analysis_points</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]</span>
<span class="n">total_alpha</span> <span class="o">=</span> <span class="mf">0.05</span>
<span class="n">alpha_thresholds</span> <span class="o">=</span> <span class="p">[</span><span class="n">obrien_fleming</span><span class="p">(</span><span class="n">point</span><span class="p">,</span> <span class="n">total_time</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">total_alpha</span><span class="p">)</span> <span class="k">for</span> <span class="n">point</span> <span class="ow">in</span> <span class="n">analysis_points</span><span class="p">]</span>

<span class="k">for</span> <span class="n">point</span><span class="p">,</span> <span class="n">threshold</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">analysis_points</span><span class="p">,</span> <span class="n">alpha_thresholds</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Analysis at </span><span class="si">{</span><span class="n">point</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% data: Alpha threshold = </span><span class="si">{</span><span class="n">threshold</span><span class="si">:</span><span class="s2">.4f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Example observed p-values from interim analyses</span>
<span class="n">observed_p_values</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.049</span><span class="p">,</span> <span class="mf">0.045</span><span class="p">,</span> <span class="mf">0.025</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span>

<span class="c1"># Decisions based on alpha-spending</span>
<span class="n">decisions</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Reject H0&quot;</span> <span class="k">if</span> <span class="n">p</span> <span class="o">&lt;=</span> <span class="n">alpha</span> <span class="k">else</span> <span class="s2">&quot;Do not reject H0&quot;</span> <span class="k">for</span> <span class="n">p</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">observed_p_values</span><span class="p">,</span> <span class="n">alpha_thresholds</span><span class="p">)]</span>
<span class="k">for</span> <span class="n">point</span><span class="p">,</span> <span class="n">decision</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">analysis_points</span><span class="p">,</span> <span class="n">decisions</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Decision at </span><span class="si">{</span><span class="n">point</span><span class="o">*</span><span class="mi">100</span><span class="si">}</span><span class="s2">% data: </span><span class="si">{</span><span class="n">decision</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Analysis at 25.0% data: Alpha threshold = 0.0269
Analysis at 50.0% data: Alpha threshold = 0.0352
Analysis at 75.0% data: Alpha threshold = 0.0427
Analysis at 100.0% data: Alpha threshold = 0.0500
Decision at 25.0% data: Do not reject H0
Decision at 50.0% data: Do not reject H0
Decision at 75.0% data: Reject H0
Decision at 100.0% data: Reject H0
</pre></div>
</div>
</div>
</div>
</section>
<section id="bayesian-a-b-testing">
<h3>Bayesian A/B testing <a name="Bayesian"></a><a class="headerlink" href="#bayesian-a-b-testing" title="Link to this heading">#</a></h3>
<p>Estimate the posterior distributions of the metrics of interest (like conversion rates) directly, rather than relying on p-values from hypothesis testing.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">pymc</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pm</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">arviz</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">az</span>

<span class="c1"># Number of visitors</span>
<span class="n">n_A</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># Control</span>
<span class="n">n_B</span> <span class="o">=</span> <span class="mi">1500</span> <span class="c1"># Treatment</span>

<span class="c1"># Number of conversions</span>
<span class="n">conversions_A</span> <span class="o">=</span> <span class="mi">105</span>  
<span class="n">conversions_B</span> <span class="o">=</span> <span class="mi">125</span>

<span class="k">with</span> <span class="n">pm</span><span class="o">.</span><span class="n">Model</span><span class="p">()</span> <span class="k">as</span> <span class="n">model</span><span class="p">:</span>
    <span class="c1"># Prior distributions for probabilities of conversion</span>
    <span class="n">p_A</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;p_A&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">p_B</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Beta</span><span class="p">(</span><span class="s1">&#39;p_B&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">beta</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

    <span class="c1"># Likelihood functions</span>
    <span class="n">obs_A</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="s1">&#39;obs_A&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_A</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_A</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">conversions_A</span><span class="p">)</span>
    <span class="n">obs_B</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">Binomial</span><span class="p">(</span><span class="s1">&#39;obs_B&#39;</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n_B</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p_B</span><span class="p">,</span> <span class="n">observed</span><span class="o">=</span><span class="n">conversions_B</span><span class="p">)</span>

    <span class="c1"># Sample from the posterior</span>
    <span class="n">trace</span> <span class="o">=</span> <span class="n">pm</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="n">progressbar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">return_inferencedata</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Plotting the posterior distributions with reference line at 0</span>
<span class="n">az</span><span class="o">.</span><span class="n">plot_posterior</span><span class="p">(</span><span class="n">trace</span><span class="p">,</span> <span class="n">var_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;p_A&#39;</span><span class="p">,</span> <span class="s1">&#39;p_B&#39;</span><span class="p">],</span> <span class="n">ref_val</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># Calculate the probability that B is better than A</span>
<span class="n">prob_B_better_than_A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">trace</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;p_B&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span> <span class="o">&gt;</span> <span class="n">trace</span><span class="o">.</span><span class="n">posterior</span><span class="p">[</span><span class="s1">&#39;p_A&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Probability that B is better than A: </span><span class="si">{</span><span class="n">prob_B_better_than_A</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Auto-assigning NUTS sampler...
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (4 chains in 4 jobs)
NUTS: [p_A, p_B]
Sampling 4 chains for 1_000 tune and 5_000 draw iterations (4_000 + 20_000 draws total) took 2 seconds.
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Probability that B is better than A: 0.92
</pre></div>
</div>
<img alt="../_images/d2dfa4ed4c75da3c2905e8acbe198b06334084df2e8b27f2dd00efd9cb3f24ee.png" src="../_images/d2dfa4ed4c75da3c2905e8acbe198b06334084df2e8b27f2dd00efd9cb3f24ee.png" />
</div>
</div>
<p>Example from <a class="reference external" href="https://nbviewer.org/github/CamDavidsonPilon/Probabilistic-Programming-and-Bayesian-Methods-for-Hackers/blob/master/Chapter1_Introduction/Ch1_Introduction_PyMC2.ipynb">Probabilistic Programming and Bayesian Methods for Hackers</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">beta</span>
<span class="n">n_trials</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">bernoulli</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n_trials</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">N</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">n_trials</span><span class="p">):</span>
    <span class="n">sx</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">n_trials</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;$p$, probability of heads&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="k">else</span> <span class="kc">None</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">sx</span><span class="o">.</span><span class="n">get_yticklabels</span><span class="p">(),</span> <span class="n">visible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">heads</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="n">N</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">heads</span><span class="p">,</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">N</span> <span class="o">-</span> <span class="n">heads</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;observe </span><span class="si">%d</span><span class="s2"> tosses,</span><span class="se">\n</span><span class="s2"> </span><span class="si">%d</span><span class="s2"> heads&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">N</span><span class="p">,</span> <span class="n">heads</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;#348ABD&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linestyles</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">leg</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">leg</span><span class="o">.</span><span class="n">get_frame</span><span class="p">()</span><span class="o">.</span><span class="n">set_alpha</span><span class="p">(</span><span class="mf">0.4</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Bayesian updating of posterior probabilities&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/43b211c0e7565f82f3787193de813f23ede73e6cd1547956b29c97b67114cd32.png" src="../_images/43b211c0e7565f82f3787193de813f23ede73e6cd1547956b29c97b67114cd32.png" />
</div>
</div>
</section>
</section>
<section id="data-distribution-tests">
<h2>Data Distribution Tests<a class="headerlink" href="#data-distribution-tests" title="Link to this heading">#</a></h2>
<section id="shapiro-wilk-test-normal-distributions">
<h3>Shapiro-Wilk Test (Normal Distributions)  <a name="Shapiro-Wilk"></a><a class="headerlink" href="#shapiro-wilk-test-normal-distributions" title="Link to this heading">#</a></h3>
<p><strong>Purpose</strong>: It checks how well the data conforms to a normal distribution. More powerful than the K-S test in detecting departures from normality, particularly for small to moderate sample sizes (typically less than 50 samples, though it can be used up to 2000).</p>
</section>
<section id="kolmogorov-smirnov-test">
<h3>Kolmogorov-Smirnov Test <a name="Kolmogorov-Smirnov"></a><a class="headerlink" href="#kolmogorov-smirnov-test" title="Link to this heading">#</a></h3>
<p><strong>Purpose</strong>: Used to compare a sample with a reference probability distribution (which can be, but is not limited to, a normal distribution). It tests whether two samples are drawn from the same distribution or to compare a sample with a theoretical distribution such as the normal distribution. Generally, the K-S test is considered reliable for larger samples.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">standard_normal</span><span class="p">(</span><span class="n">sample_size</span><span class="p">)</span>

<span class="c1"># Shapiro-Wilk Test for normality</span>
<span class="n">shapiro_test_stat</span><span class="p">,</span> <span class="n">shapiro_p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">shapiro</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shapiro-Wilk: p-value = </span><span class="si">{</span><span class="n">shapiro_p_value</span><span class="si">:</span><span class="s2">0.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Kolmogorov-Smirnov Test comparing sample data to a normal distribution</span>
<span class="n">ks_test_stat</span><span class="p">,</span> <span class="n">ks_p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">kstest</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">data</span><span class="o">.</span><span class="n">std</span><span class="p">()))</span>
<span class="c1"># ks_test_stat, ks_p_value = stats.kstest(data, stats.norm.cdf)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kolmogorov-Smirnov: p-value = </span><span class="si">{</span><span class="n">ks_p_value</span><span class="si">:</span><span class="s2">0.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Shapiro-Wilk: p-value = 0.7296
Kolmogorov-Smirnov: p-value = 0.8344
</pre></div>
</div>
</div>
</div>
</section>
<section id="kullbackleibler-divergence">
<h3>Kullback–Leibler divergence <a name="Kullback–Leibler"></a><a class="headerlink" href="#kullbackleibler-divergence" title="Link to this heading">#</a></h3>
<p><strong>Purpose</strong>: Measures how one probability distribution is different from a second.</p>
<p>Not typically used for data distribution tests for a few reasons:</p>
<ol class="arabic simple">
<li><p>Doesn’t offer a probabilistic interpretation or a hypothesis test framework like p-values.</p></li>
<li><p>The first distribution <span class="math notranslate nohighlight">\(P\)</span> must be continuous with respect to the second distribution <span class="math notranslate nohighlight">\(𝑄\)</span>. <span class="math notranslate nohighlight">\(P\)</span> can only be non-zero where <span class="math notranslate nohighlight">\(Q\)</span> is non-zero or the KL divergence will be undefined or infinite.</p></li>
<li><p>Not symmetric <span class="math notranslate nohighlight">\( D_{KL}(P | Q) ≠ D_{KL}(Q | P) \)</span></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">)</span>
<span class="n">B</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">low</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">high</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">sample_size</span><span class="p">)</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">A</span> <span class="o">+</span> <span class="mf">1e-10</span>  <span class="c1"># adding small value to avoid division by zero</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">B</span> <span class="o">+</span> <span class="mf">1e-10</span>  <span class="c1"># adding small value to avoid division by zero</span>
<span class="n">kl_divergence</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kullback-Leibler Divergence: </span><span class="si">{</span><span class="n">kl_divergence</span><span class="si">:</span><span class="s2">0.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Alternatively, using histograms</span>
<span class="n">hist_p</span><span class="p">,</span> <span class="n">bin_edges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">hist_q</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">kl_divergence_hist</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">entropy</span><span class="p">(</span><span class="n">hist_p</span><span class="p">,</span> <span class="n">hist_q</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Kullback-Leibler Divergence (histogram method): </span><span class="si">{</span><span class="n">kl_divergence_hist</span><span class="si">:</span><span class="s2">0.04f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">B</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#1f77b4&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;B&#39;</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#771f4b&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;A&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;A Mean </span><span class="si">{</span><span class="n">A</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;B Mean </span><span class="si">{</span><span class="n">B</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s1">.01f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Sample Distribution&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Kullback-Leibler Divergence: 0.2484
Kullback-Leibler Divergence (histogram method): 0.1083
</pre></div>
</div>
<img alt="../_images/a70661a37109f542947c07c6901446b4a90de35acdf09a80d02fa68f85c4c11e.png" src="../_images/a70661a37109f542947c07c6901446b4a90de35acdf09a80d02fa68f85c4c11e.png" />
</div>
</div>
</section>
</section>
<section id="simpson-s-paradox">
<h2><a class="reference external" href="https://en.wikipedia.org/wiki/Simpson's_paradox">Simpson’s Paradox</a><a class="headerlink" href="#simpson-s-paradox" title="Link to this heading">#</a></h2>
<p>Describes a situation where a trend appears in groups of data, but changes when the groups are combined.</p>
<section id="example">
<h3>Example<a class="headerlink" href="#example" title="Link to this heading">#</a></h3>
<p>We run an experiment on two days. The first day we apply the treatment to 1% of users and the next day to 50% of users.</p>
<p>The treatment has a better success rate on both days, but when we average the result, it is worse overall due to to weighted averaging.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span> <span class="c1"># Setting a seed so it&#39;s reproducable</span>

<span class="k">def</span><span class="w"> </span><span class="nf">run_experiment</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">num_simulations</span><span class="p">):</span>
    <span class="n">successes</span> <span class="o">=</span> <span class="n">rng</span><span class="o">.</span><span class="n">binomial</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="n">p</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">num_simulations</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">failures</span> <span class="o">=</span> <span class="n">num_simulations</span> <span class="o">-</span> <span class="n">successes</span>
    <span class="n">success_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">successes</span><span class="p">)</span>
    <span class="n">failure_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">failures</span><span class="p">)</span>

<span class="n">success_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">failure_list</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1"># Day 1: 1% Treatment</span>
<span class="n">run_experiment</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.62</span><span class="p">,</span> <span class="n">num_simulations</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
<span class="n">run_experiment</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.57</span><span class="p">,</span> <span class="n">num_simulations</span><span class="o">=</span><span class="mi">9500</span><span class="p">)</span>

<span class="c1"># Day 2: 50% Treatment</span>
<span class="n">run_experiment</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">num_simulations</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>
<span class="n">run_experiment</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.45</span><span class="p">,</span> <span class="n">num_simulations</span><span class="o">=</span><span class="mi">5000</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Treatment or Control&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">,</span> <span class="s2">&quot;Treatment&quot;</span><span class="p">,</span> <span class="s2">&quot;Control&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Day of Test&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 1&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">,</span> <span class="s2">&quot;Day 2&quot;</span><span class="p">],</span>
    <span class="s2">&quot;Success&quot;</span><span class="p">:</span> <span class="n">success_list</span><span class="p">,</span> 
    <span class="s2">&quot;Failure&quot;</span><span class="p">:</span> <span class="n">failure_list</span>
<span class="p">})</span>

<span class="n">df</span><span class="p">[</span><span class="s1">&#39;Rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Success&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;Success&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;Failure&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Daily Results:&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Daily Results:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Treatment or Control</th>
      <th>Day of Test</th>
      <th>Success</th>
      <th>Failure</th>
      <th>Rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Treatment</td>
      <td>Day 1</td>
      <td>308</td>
      <td>192</td>
      <td>62.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Control</td>
      <td>Day 1</td>
      <td>5463</td>
      <td>4037</td>
      <td>58.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Treatment</td>
      <td>Day 2</td>
      <td>2522</td>
      <td>2478</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Control</td>
      <td>Day 2</td>
      <td>2301</td>
      <td>2699</td>
      <td>46.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Average Results:&quot;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;Day of Test&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">grouped_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Treatment or Control&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="n">grouped_df</span><span class="p">[</span><span class="s1">&#39;Rate&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">100</span> <span class="o">*</span> <span class="n">grouped_df</span><span class="p">[</span><span class="s1">&#39;Success&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">grouped_df</span><span class="p">[</span><span class="s1">&#39;Success&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">grouped_df</span><span class="p">[</span><span class="s1">&#39;Failure&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">grouped_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Average Results:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Success</th>
      <th>Failure</th>
      <th>Rate</th>
    </tr>
    <tr>
      <th>Treatment or Control</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Control</th>
      <td>7764</td>
      <td>6736</td>
      <td>54.0</td>
    </tr>
    <tr>
      <th>Treatment</th>
      <td>2830</td>
      <td>2670</td>
      <td>51.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Link to this heading">#</a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://en.wikiversity.org/wiki/Analysis_of_variance">Analysis of Variance - Wikiversity</a></p></li>
</ul>
<div class="docutils container" id="id4">
<div role="list" class="citation-list">
<div class="citation" id="id8" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">man</a><span class="fn-bracket">]</span></span>
<p>Mann-whitney u-test. <a class="reference external" href="https://sites.utexas.edu/sos/guided/inferential/numeric/onecat/2-groups/independent/u-test/">https://sites.utexas.edu/sos/guided/inferential/numeric/onecat/2-groups/independent/u-test/</a>. Accessed: 2025-01-30.</p>
</div>
<div class="citation" id="id6" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id1">Coh94</a><span class="fn-bracket">]</span></span>
<p>Jacob Cohen. The earth is round (p &lt; .05). <em>American Psychologist</em>, 49(12):997–1003, 1994.</p>
</div>
<div class="citation" id="id7" role="doc-biblioentry">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id2">KS25</a><span class="fn-bracket">]</span></span>
<p>Mark A. Kohn and Janet Senyak. Sample size calculators. \textit UCSF CTSI Website, 2025. Available at <a class="reference external" href="https://www.sample-size.net/">https://www.sample-size.net/</a> [Accessed 30 January 2025].</p>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Notebooks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="scaling.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Scaling</p>
      </div>
    </a>
    <a class="right-next"
       href="time_series.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Time Series</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#steps-to-assess-statistical-significance">Steps to Assess Statistical Significance: <a name="assess-significance"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-statistical-power">Sample Size and Statistical Power: <a name="Sample-Size-and-Statstical-Power"></a> <br/></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-size-and-minimum-detectable-effect">Sample Size and Minimum Detectable Effect</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#margin-of-error-moe">Margin of Error (MoE)  <a name="Margin of Error"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-proportion-moe">Sample Proportion MoE</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#sample-mean-moe">Sample Mean MoE</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#confidence-intervals-ci">Confidence Intervals (CI)  <a name="Confidence Intervals"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#common-statstical-tests">Common Statstical Tests <a name="common-statistical-tests"></a></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#z-tests-t-tests-compare-the-means-of-two-groups"><strong>Z-tests / T-tests</strong>: Compare the means of two groups.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#anova-analysis-of-variance-compare-the-means-of-three-or-more-groups"><strong>ANOVA (Analysis of Variance)</strong>: Compare the means of three or more groups.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-signed-rank-test-non-parametric-test-to-compare-the-median-of-a-set-of-numbers-against-a-hypothetical-median"><strong>Wilcoxon Signed-Rank Test</strong>: Non-parametric test to compare the median of a set of numbers against a hypothetical median.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#mann-whitney-u-test-non-parametric-test-to-determine-whether-a-numeric-outcome-variable-with-any-distribution-differs-across-two-independent-groups"><strong>Mann-Whitney U-Test</strong>: Non-parametric test to determine whether a numeric outcome variable with any distribution differs across two independent groups.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-tests-test-the-relationship-between-categorical-variables"><strong>Chi-squared Tests</strong>: Test the relationship between categorical variables.</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#regression-analysis-model-the-relationship-between-a-dependent-variable-and-one-or-more-independent-variables"><strong>Regression Analysis</strong>: Model the relationship between a dependent variable and one or more independent variables.</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#examples">Examples</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-tests-one-sample">T-Tests: One-Sample</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-tests-independent-two-sample">T-Tests: Independent (Two-sample)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#welch-s-t-test-for-unequal-variance">Welch’s t-test for unequal variance</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#t-tests-paired-dependent">T-Tests: Paired (Dependent)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#wilcoxon-signed-rank-test">Wilcoxon Signed-Rank Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-square-goodness-of-fit">Chi-square Goodness of Fit</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-squared-independence-fisher-s-exact-test-g-test">Chi-squared Independence / Fisher’s Exact Test / G-Test</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chi-square-goodness-of-fit-test">Chi-square Goodness-of-Fit Test:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#g-test-goodness-of-fit">G-Test (Goodness-of-Fit):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#one-way-anova">One-way ANOVA</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#permutation-test">Permutation Test</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#p-value-correction-for-multiple-tests">P-Value Correction for Multiple Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bonferroni-correction">Bonferroni correction</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#false-discovery-rate-fdr">False discovery rate (FDR)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multiple-tests-example">Multiple Tests Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#sequential-testing">Sequential Testing</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#alpha-spending">Alpha-Spending <a name="Alpha-Spending"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#bayesian-a-b-testing">Bayesian A/B testing <a name="Bayesian"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data-distribution-tests">Data Distribution Tests</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#shapiro-wilk-test-normal-distributions">Shapiro-Wilk Test (Normal Distributions)  <a name="Shapiro-Wilk"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kolmogorov-smirnov-test">Kolmogorov-Smirnov Test <a name="Kolmogorov-Smirnov"></a></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#kullbackleibler-divergence">Kullback–Leibler divergence <a name="Kullback–Leibler"></a></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#simpson-s-paradox">Simpson’s Paradox</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#example">Example</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#references">References</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Jordan Barker
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>